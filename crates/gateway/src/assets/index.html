<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="color-scheme" content="dark light">
<title>moltis</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' rx='6' fill='%23333'/><text x='16' y='22' font-size='20' text-anchor='middle' fill='white' font-family='system-ui'>M</text></svg>">
<meta name="build-ts" content="__BUILD_TS__">
<script type="importmap">
{
  "imports": {
    "preact": "/assets/js/vendor/preact.mjs",
    "preact/hooks": "/assets/js/vendor/preact-hooks.mjs",
    "@preact/signals": "/assets/js/vendor/preact-signals.mjs",
    "htm/preact": "/assets/js/vendor/htm-preact.mjs"
  }
}
</script>
<link rel="stylesheet" href="/assets/css/base.css">
<link rel="stylesheet" href="/assets/css/layout.css">
<link rel="stylesheet" href="/assets/css/chat.css">
<link rel="stylesheet" href="/assets/css/components.css">
<link rel="modulepreload" href="/assets/js/app.js">
<link rel="modulepreload" href="/assets/js/state.js">
<link rel="modulepreload" href="/assets/js/theme.js">
<link rel="modulepreload" href="/assets/js/helpers.js">
<link rel="modulepreload" href="/assets/js/events.js">
<link rel="modulepreload" href="/assets/js/router.js">
<link rel="modulepreload" href="/assets/js/websocket.js">
<link rel="modulepreload" href="/assets/js/sessions.js">
<link rel="modulepreload" href="/assets/js/session-search.js">
<link rel="modulepreload" href="/assets/js/models.js">
<link rel="modulepreload" href="/assets/js/projects.js">
<link rel="modulepreload" href="/assets/js/project-combo.js">
<link rel="modulepreload" href="/assets/js/providers.js">
<link rel="modulepreload" href="/assets/js/chat-ui.js">
<link rel="modulepreload" href="/assets/js/icons.js">
<link rel="modulepreload" href="/assets/js/sandbox.js">
<link rel="modulepreload" href="/assets/js/logs-alert.js">
<link rel="modulepreload" href="/assets/js/page-chat.js">
<link rel="modulepreload" href="/assets/js/page-crons.js">
<link rel="modulepreload" href="/assets/js/page-projects.js">
<link rel="modulepreload" href="/assets/js/page-providers.js">
<link rel="modulepreload" href="/assets/js/page-channels.js">
<link rel="modulepreload" href="/assets/js/page-logs.js">
<link rel="modulepreload" href="/assets/js/page-skills.js">
<link rel="modulepreload" href="/assets/js/page-settings.js">
<link rel="modulepreload" href="/assets/js/vendor/preact.mjs">
<link rel="modulepreload" href="/assets/js/vendor/preact-hooks.mjs">
<link rel="modulepreload" href="/assets/js/vendor/preact-signals.mjs">
<link rel="modulepreload" href="/assets/js/vendor/htm-preact.mjs">
</head>
<body>

<!-- Top bar -->
<header class="flex items-center gap-3 px-4 py-2.5 border-b border-[var(--border)] bg-[var(--surface)] shrink-0">
  <button id="burgerBtn" class="burger-btn" title="Navigation">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20"><path d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"/></svg>
  </button>
  <a href="/chats" id="titleLink" class="text-base font-medium tracking-wide text-[var(--text-strong)]" style="text-decoration:none;cursor:pointer">moltis</a>
  <span class="status-dot" id="statusDot"></span>
  <span class="text-xs text-[var(--muted)]" id="statusText">disconnected</span>
  <div class="flex-1"></div>

  <!-- Theme toggle -->
  <div class="theme-toggle" id="themeToggle">
    <button class="theme-btn" data-theme-val="light" title="Light theme">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><circle cx="12" cy="12" r="5"/><path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72 1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>
    </button>
    <button class="theme-btn" data-theme-val="system" title="System theme">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><rect x="2" y="3" width="20" height="14" rx="2"/><path d="M8 21h8m-4-4v4"/></svg>
    </button>
    <button class="theme-btn" data-theme-val="dark" title="Dark theme">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75 9.75 9.75 0 0 1 8.25 6c0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25 9.75 9.75 0 0 0 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z"/></svg>
    </button>
  </div>

</header>

<!-- Main layout -->
<div class="flex flex-1 min-h-0 overflow-hidden">
  <!-- Navigation panel -->
  <nav id="navPanel" class="nav-panel">
    <div class="flex-1 flex flex-col">
      <a href="/chats" data-nav class="nav-link" style="display:flex;align-items:center;gap:8px">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.3 48.3 0 0 0 5.862-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.4 48.4 0 0 0 12 3a48.4 48.4 0 0 0-5.775.514C4.623 3.746 3.5 5.14 3.5 6.74v6.009Z"/></svg>
        Chat
      </a>
      <a href="/crons" data-nav class="nav-link" style="display:flex;align-items:center;gap:8px">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/></svg>
        Crons
      </a>
      <a href="/projects" data-nav class="nav-link" style="display:flex;align-items:center;gap:8px">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"/></svg>
        Projects
      </a>
      <a href="/providers" data-nav class="nav-link" style="display:flex;align-items:center;gap:8px">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 14.25H18.75M5.25 14.25C3.59315 14.25 2.25 12.9069 2.25 11.25M5.25 14.25C3.59315 14.25 2.25 15.5931 2.25 17.25C2.25 18.9069 3.59315 20.25 5.25 20.25H18.75C20.4069 20.25 21.75 18.9069 21.75 17.25C21.75 15.5931 20.4069 14.25 18.75 14.25M2.25 11.25C2.25 9.59315 3.59315 8.25 5.25 8.25H18.75C20.4069 8.25 21.75 9.59315 21.75 11.25M2.25 11.25C2.25 10.2763 2.5658 9.32893 3.15 8.55L5.7375 5.1C6.37488 4.25016 7.37519 3.75 8.4375 3.75H15.5625C16.6248 3.75 17.6251 4.25016 18.2625 5.1L20.85 8.55C21.4342 9.32893 21.75 10.2763 21.75 11.25M21.75 11.25C21.75 12.9069 20.4069 14.25 18.75 14.25M18.75 17.25H18.7575V17.2575H18.75V17.25ZM18.75 11.25H18.7575V11.2575H18.75V11.25ZM15.75 17.25H15.7575V17.2575H15.75V17.25ZM15.75 11.25H15.7575V11.2575H15.75V11.25Z"/></svg>
        Providers
      </a>
      <a href="/channels" data-nav class="nav-link" style="display:flex;align-items:center;gap:8px">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M5.25 8.25h15m-16.5 7.5h15m-1.8-13.5-3.9 19.5m-2.1-19.5-3.9 19.5"/></svg>
        Channels
      </a>
      <a href="/skills" data-nav class="nav-link" style="display:flex;align-items:center;gap:8px">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.455 2.456L21.75 6l-1.036.259a3.375 3.375 0 0 0-2.455 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"/></svg>
        Skills
      </a>
      <a href="/logs" data-nav class="nav-link" id="navLogs" style="display:flex;align-items:center;gap:8px;position:relative">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"/></svg>
        Logs
        <span id="logsAlertDot" style="display:none;width:7px;height:7px;border-radius:50%;background:var(--warn);position:absolute;top:50%;right:8px;transform:translateY(-50%)"></span>
      </a>
    </div>
    <div class="border-t border-[var(--border)]">
      <a href="/settings" data-nav class="nav-link" style="display:flex;align-items:center;gap:8px">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16"><path stroke-linecap="round" stroke-linejoin="round" d="M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.248a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"/><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/></svg>
        Settings
      </a>
    </div>
  </nav>

  <!-- Sessions sidebar -->
  <div class="w-[240px] border-r border-[var(--border)] flex flex-col bg-[var(--surface)] shrink-0 hidden" id="sessionsPanel">
    <div class="px-3 py-2.5 border-b border-[var(--border)] flex items-center justify-between">
      <span class="text-sm text-[var(--muted)] font-medium">Sessions</span>
      <button id="newSessionBtn" class="text-xs text-[var(--muted)] border border-[var(--border)] px-2 py-0.5 rounded hover:text-[var(--text)] hover:border-[var(--border-strong)] transition-colors cursor-pointer bg-transparent">+ New</button>
    </div>
    <!-- Project selector -->
    <div class="px-3 py-2 border-b border-[var(--border)] flex items-center gap-2">
      <select id="projectSelect" class="flex-1 text-xs bg-[var(--surface2)] border border-[var(--border)] rounded px-2 py-1.5 text-[var(--text)] focus:outline-none focus:border-[var(--border-strong)] cursor-pointer" style="font-family:var(--font-body)">
        <option value="">No project</option>
      </select>
      <button id="manageProjectsBtn" class="text-xs text-[var(--muted)] border border-[var(--border)] px-2 py-0.5 rounded hover:text-[var(--text)] hover:border-[var(--border-strong)] transition-colors cursor-pointer bg-transparent" title="Manage projects">+</button>
    </div>
    <div class="px-3 py-2 border-b border-[var(--border)]" style="position:relative">
      <input id="sessionSearch" type="text" placeholder="Search sessions…"
             class="w-full text-xs bg-[var(--surface2)] border border-[var(--border)] rounded px-2 py-1.5 text-[var(--text)] focus:outline-none focus:border-[var(--border-strong)]" style="font-family:var(--font-body)" />
      <div id="searchResults" class="hidden"></div>
    </div>
    <div class="flex-1 overflow-y-auto" id="sessionList"></div>
  </div>

  <!-- Page content (swapped by router) -->
  <div id="pageContent" class="flex-1 flex flex-col min-w-0 overflow-hidden"></div>
</div>

<!-- Modals (created on demand by modals.js) -->
<div id="modalRoot"></div>

<!-- Templates -->
<template id="tpl-thinking-dots">
  <span class="thinking-dots"><span></span><span></span><span></span></span>
</template>

<template id="tpl-exec-card">
  <div class="msg exec-card running">
    <div class="exec-prompt">
      <span class="exec-prompt-char">$</span>
      <span data-cmd></span>
    </div>
    <div class="exec-status">running…</div>
  </div>
</template>

<template id="tpl-approval-card">
  <div class="msg approval-card">
    <div class="approval-label">Command requires approval:</div>
    <code class="approval-cmd"></code>
    <div class="approval-btns">
      <button class="approval-btn approval-allow">Allow</button>
      <button class="approval-btn approval-deny">Deny</button>
    </div>
    <div class="approval-countdown"></div>
  </div>
</template>

<template id="tpl-session-item">
  <div class="session-item">
    <div class="session-info">
      <div class="session-label" style="display:flex;align-items:center;gap:5px">
        <span class="session-icon"></span>
        <span data-label-text></span>
      </div>
      <div class="session-meta"></div>
    </div>
    <div class="session-actions"></div>
  </div>
</template>

<script type="module" src="/assets/js/app.js"></script>
</body>
</html>
