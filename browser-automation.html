<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Browser Automation - Moltis Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="Documentation for Moltis - Your AI coding assistant">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/admonish.css">
        <link rel="stylesheet" href="theme/custom.css">


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Moltis Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/moltis-org/moltis" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/moltis-org/moltis/edit/main/docs/src/src/browser-automation.md" title="Suggest an edit" aria-label="Suggest an edit" rel="edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="browser-automation"><a class="header" href="#browser-automation">Browser Automation</a></h1>
<p>Moltis provides full browser automation via Chrome DevTools Protocol (CDP),
enabling agents to interact with JavaScript-heavy websites, fill forms,
click buttons, and capture screenshots.</p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Browser automation is useful when you need to:</p>
<ul>
<li>Interact with SPAs (Single Page Applications)</li>
<li>Fill forms and click buttons</li>
<li>Navigate sites that require JavaScript rendering</li>
<li>Take screenshots of pages</li>
<li>Execute JavaScript in page context</li>
<li>Maintain session state across multiple interactions</li>
</ul>
<p>For simple page content retrieval (static HTML), prefer <code>web_fetch</code> as it’s
faster and more lightweight.</p>
<h2 id="architecture"><a class="header" href="#architecture">Architecture</a></h2>
<pre><code>┌─────────────────┐     ┌─────────────────┐     ┌──────────────────┐
│   BrowserTool   │────▶│  BrowserManager │────▶│   BrowserPool    │
│   (AgentTool)   │     │   (actions)     │     │   (instances)    │
└─────────────────┘     └─────────────────┘     └──────────────────┘
                                                         │
                                                         ▼
                                                ┌──────────────────┐
                                                │  Chrome/Chromium │
                                                │     via CDP      │
                                                └──────────────────┘
</code></pre>
<h3 id="components"><a class="header" href="#components">Components</a></h3>
<ul>
<li><strong>BrowserTool</strong> (<code>crates/tools/src/browser.rs</code>) - AgentTool wrapper for LLM</li>
<li><strong>BrowserManager</strong> (<code>crates/browser/src/manager.rs</code>) - High-level action API</li>
<li><strong>BrowserPool</strong> (<code>crates/browser/src/pool.rs</code>) - Chrome instance management</li>
<li><strong>Snapshot</strong> (<code>crates/browser/src/snapshot.rs</code>) - DOM element extraction</li>
</ul>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<p>Browser automation is <strong>enabled by default</strong>. To customize, add to your <code>moltis.toml</code>:</p>
<pre><code class="language-toml">[tools.browser]
enabled = true              # Enable browser support
headless = true             # Run without visible window (default)
viewport_width = 2560       # Default viewport width
viewport_height = 1440      # Default viewport height
device_scale_factor = 2.0   # HiDPI/Retina scaling (1.0 = standard, 2.0 = Retina)

# Pool management
max_instances = 0           # 0 = unlimited (limited by memory), &gt;0 = hard limit
memory_limit_percent = 90   # Block new instances when memory exceeds this %
idle_timeout_secs = 300     # Close idle browsers after 5 min
navigation_timeout_ms = 30000  # Page load timeout

# Optional customization
# chrome_path = "/path/to/chrome"  # Custom Chrome path
# user_agent = "Custom UA"         # Custom user agent
# chrome_args = ["--disable-extensions"]  # Extra args

# Sandbox image (browser sandbox mode follows session sandbox mode)
sandbox_image = "browserless/chrome"  # Container image for sandboxed sessions
# allowed_domains = ["example.com", "*.trusted.org"]  # Restrict navigation
</code></pre>
<h3 id="memory-based-pool-limits"><a class="header" href="#memory-based-pool-limits">Memory-Based Pool Limits</a></h3>
<p>By default, browser instances are limited by system memory rather than a fixed count:</p>
<ul>
<li><code>max_instances = 0</code> (default): Unlimited instances, blocked only when memory
exceeds <code>memory_limit_percent</code></li>
<li><code>memory_limit_percent = 90</code>: New browsers blocked when system memory &gt; 90%</li>
<li>Set <code>max_instances &gt; 0</code> for a hard limit if you prefer fixed constraints</li>
</ul>
<p>This allows multiple chat sessions to each have their own browser without
artificial limits, while protecting system stability when memory is constrained.</p>
<h3 id="domain-restrictions"><a class="header" href="#domain-restrictions">Domain Restrictions</a></h3>
<p>For improved security, you can restrict which domains the browser can navigate to:</p>
<pre><code class="language-toml">[tools.browser]
allowed_domains = [
    "docs.example.com",    # Exact match
    "*.github.com",        # Wildcard: matches any subdomain
    "localhost",           # Allow localhost
]
</code></pre>
<p>When <code>allowed_domains</code> is set, any navigation to a domain not in the list will
be blocked with an error. Wildcards (<code>*.domain.com</code>) match any subdomain and
also the base domain itself.</p>
<h2 id="tool-usage"><a class="header" href="#tool-usage">Tool Usage</a></h2>
<h3 id="actions"><a class="header" href="#actions">Actions</a></h3>
<div class="table-wrapper"><table><thead><tr><th>Action</th><th>Description</th><th>Required Params</th></tr></thead><tbody>
<tr><td><code>navigate</code></td><td>Go to a URL</td><td><code>url</code></td></tr>
<tr><td><code>snapshot</code></td><td>Get DOM with element refs</td><td>-</td></tr>
<tr><td><code>screenshot</code></td><td>Capture page image</td><td><code>full_page</code> (optional)</td></tr>
<tr><td><code>click</code></td><td>Click element by ref</td><td><code>ref_</code></td></tr>
<tr><td><code>type</code></td><td>Type into element</td><td><code>ref_</code>, <code>text</code></td></tr>
<tr><td><code>scroll</code></td><td>Scroll page/element</td><td><code>x</code>, <code>y</code>, <code>ref_</code> (optional)</td></tr>
<tr><td><code>evaluate</code></td><td>Run JavaScript</td><td><code>code</code></td></tr>
<tr><td><code>wait</code></td><td>Wait for element</td><td><code>selector</code> or <code>ref_</code></td></tr>
<tr><td><code>get_url</code></td><td>Get current URL</td><td>-</td></tr>
<tr><td><code>get_title</code></td><td>Get page title</td><td>-</td></tr>
<tr><td><code>back</code></td><td>Go back in history</td><td>-</td></tr>
<tr><td><code>forward</code></td><td>Go forward in history</td><td>-</td></tr>
<tr><td><code>refresh</code></td><td>Reload the page</td><td>-</td></tr>
<tr><td><code>close</code></td><td>Close browser session</td><td>-</td></tr>
</tbody></table>
</div>
<h3 id="automatic-session-tracking"><a class="header" href="#automatic-session-tracking">Automatic Session Tracking</a></h3>
<p>The browser tool automatically tracks and reuses session IDs. After a <code>navigate</code>
action creates a session, subsequent actions will reuse it without needing to
pass <code>session_id</code> explicitly:</p>
<pre><code class="language-json">// 1. Navigate (creates session)
{ "action": "navigate", "url": "https://example.com" }

// 2. Snapshot (session_id auto-injected)
{ "action": "snapshot" }

// 3. Click (session_id auto-injected)
{ "action": "click", "ref_": 1 }

// 4. Screenshot (session_id auto-injected)
{ "action": "screenshot" }

// 5. Close (clears tracked session)
{ "action": "close" }
</code></pre>
<p>This prevents pool exhaustion from LLMs that forget to pass the session_id.</p>
<h3 id="workflow-example"><a class="header" href="#workflow-example">Workflow Example</a></h3>
<pre><code class="language-json">// 1. Navigate to a page
{
  "action": "navigate",
  "url": "https://example.com/login"
}
// Returns: { "session_id": "browser-abc123", "url": "https://..." }

// 2. Get interactive elements (session_id optional - auto-tracked)
{
  "action": "snapshot"
}
// Returns element refs like:
// { "elements": [
//   { "ref_": 1, "tag": "input", "role": "textbox", "placeholder": "Email" },
//   { "ref_": 2, "tag": "input", "role": "textbox", "placeholder": "Password" },
//   { "ref_": 3, "tag": "button", "role": "button", "text": "Sign In" }
// ]}

// 3. Fill in the form
{
  "action": "type",
  "ref_": 1,
  "text": "user@example.com"
}

{
  "action": "type",
  "ref_": 2,
  "text": "password123"
}

// 4. Click the submit button
{
  "action": "click",
  "ref_": 3
}

// 5. Take a screenshot of the result
{
  "action": "screenshot"
}
// Returns: { "screenshot": "data:image/png;base64,..." }
</code></pre>
<h2 id="element-reference-system"><a class="header" href="#element-reference-system">Element Reference System</a></h2>
<p>The snapshot action extracts interactive elements and assigns them numeric
references. This approach (inspired by <a href="https://docs.openclaw.ai">OpenClaw</a>)
provides:</p>
<ul>
<li><strong>Stability</strong>: References don’t break with minor page updates</li>
<li><strong>Security</strong>: No CSS selectors exposed to the model</li>
<li><strong>Reliability</strong>: Elements identified by role/content, not fragile paths</li>
</ul>
<h3 id="extracted-element-info"><a class="header" href="#extracted-element-info">Extracted Element Info</a></h3>
<pre><code class="language-json">{
  "ref_": 1,
  "tag": "button",
  "role": "button",
  "text": "Submit",
  "href": null,
  "placeholder": null,
  "value": null,
  "aria_label": "Submit form",
  "visible": true,
  "interactive": true,
  "bounds": { "x": 100, "y": 200, "width": 80, "height": 40 }
}
</code></pre>
<h2 id="comparison-browser-vs-web-fetch"><a class="header" href="#comparison-browser-vs-web-fetch">Comparison: Browser vs Web Fetch</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Feature</th><th><code>web_fetch</code></th><th><code>browser</code></th></tr></thead><tbody>
<tr><td>Speed</td><td>Fast</td><td>Slower</td></tr>
<tr><td>Resources</td><td>Minimal</td><td>Chrome instance</td></tr>
<tr><td>JavaScript</td><td>No</td><td>Yes</td></tr>
<tr><td>Forms/clicks</td><td>No</td><td>Yes</td></tr>
<tr><td>Screenshots</td><td>No</td><td>Yes</td></tr>
<tr><td>Sessions</td><td>No</td><td>Yes</td></tr>
<tr><td>Use case</td><td>Static content</td><td>Interactive sites</td></tr>
</tbody></table>
</div>
<p><strong>When to use <code>web_fetch</code>:</strong></p>
<ul>
<li>Reading documentation</li>
<li>Fetching API responses</li>
<li>Scraping static HTML</li>
</ul>
<p><strong>When to use <code>browser</code>:</strong></p>
<ul>
<li>Logging into websites</li>
<li>Filling forms</li>
<li>Interacting with SPAs</li>
<li>Sites that require JavaScript</li>
<li>Taking screenshots</li>
</ul>
<h2 id="metrics"><a class="header" href="#metrics">Metrics</a></h2>
<p>When the <code>metrics</code> feature is enabled, the browser module records:</p>
<div class="table-wrapper"><table><thead><tr><th>Metric</th><th>Description</th></tr></thead><tbody>
<tr><td><code>moltis_browser_instances_active</code></td><td>Currently running browsers</td></tr>
<tr><td><code>moltis_browser_instances_created_total</code></td><td>Total browsers launched</td></tr>
<tr><td><code>moltis_browser_instances_destroyed_total</code></td><td>Total browsers closed</td></tr>
<tr><td><code>moltis_browser_screenshots_total</code></td><td>Screenshots taken</td></tr>
<tr><td><code>moltis_browser_navigation_duration_seconds</code></td><td>Page load time histogram</td></tr>
<tr><td><code>moltis_browser_errors_total</code></td><td>Errors by type</td></tr>
</tbody></table>
</div>
<h2 id="sandbox-mode"><a class="header" href="#sandbox-mode">Sandbox Mode</a></h2>
<p>Browser sandbox mode <strong>automatically follows the session’s sandbox mode</strong>. When
a chat session uses sandbox mode (controlled by <code>[tools.exec.sandbox]</code>), the
browser tool will also run in a sandboxed container. When the session is not
sandboxed, the browser runs directly on the host.</p>
<h3 id="host-mode"><a class="header" href="#host-mode">Host Mode</a></h3>
<p>When the session is not sandboxed (or sandbox mode is “off”), Chrome runs
directly on the host machine. This is faster but the browser has full access
to the host network and filesystem.</p>
<h3 id="sandbox-mode-1"><a class="header" href="#sandbox-mode-1">Sandbox Mode</a></h3>
<p>When the session is sandboxed, Chrome runs inside a Docker container with:</p>
<ul>
<li><strong>Network isolation</strong>: Browser can access the internet but not local services</li>
<li><strong>Filesystem isolation</strong>: No access to host filesystem</li>
<li><strong>Automatic lifecycle</strong>: Container started/stopped with browser session</li>
<li><strong>Readiness detection</strong>: Waits for Chrome to be fully ready before connecting</li>
</ul>
<pre><code class="language-toml">[tools.browser]
sandbox_image = "browserless/chrome"  # Container image for sandboxed sessions
</code></pre>
<p>Requirements:</p>
<ul>
<li>Docker or Apple Container must be installed and running</li>
<li>The container image is pulled automatically on first use</li>
<li>Session sandbox mode must be enabled (<code>[tools.exec.sandbox] mode = "all"</code>)</li>
</ul>
<h3 id="exec-tool-scripts"><a class="header" href="#exec-tool-scripts">Exec Tool Scripts</a></h3>
<p>If agents need to run browser automation <strong>scripts</strong> (Puppeteer, Playwright,
Selenium) inside the command sandbox, Chromium is included in the default
sandbox packages:</p>
<pre><code class="language-bash"># Inside sandbox (via exec tool)
chromium --headless --no-sandbox --dump-dom https://example.com
</code></pre>
<p>Or use Puppeteer/Playwright in a Node.js script executed via the <code>exec</code> tool.</p>
<h2 id="security-considerations"><a class="header" href="#security-considerations">Security Considerations</a></h2>
<h3 id="prompt-injection-risk"><a class="header" href="#prompt-injection-risk">Prompt Injection Risk</a></h3>
<p><strong>Important</strong>: Web pages can contain content designed to manipulate LLM behavior
(prompt injection). When the browser tool returns page content to the LLM,
malicious sites could attempt to inject instructions.</p>
<p><strong>Mitigations</strong>:</p>
<ol>
<li>
<p><strong>Domain restrictions</strong>: Use <code>allowed_domains</code> to limit navigation to trusted
sites only. This is the most effective mitigation.</p>
</li>
<li>
<p><strong>Review returned content</strong>: The snapshot action returns element text which
could contain injected prompts. Be cautious with untrusted sites.</p>
</li>
<li>
<p><strong>Sandbox mode</strong>: Use sandboxed sessions to run the browser in an isolated
Docker container for additional security. Browser sandbox follows session
sandbox mode automatically.</p>
</li>
</ol>
<h3 id="other-security-considerations"><a class="header" href="#other-security-considerations">Other Security Considerations</a></h3>
<ol>
<li>
<p><strong>Host vs Sandbox mode</strong>: Browser sandbox mode follows the session’s sandbox
mode. For sandboxed sessions, the browser runs in a Docker container with
network/filesystem isolation. For non-sandboxed sessions, the browser runs
on the host with <code>--no-sandbox</code> for container compatibility.</p>
</li>
<li>
<p><strong>Resource limits</strong>: Browser instances are limited by memory usage (default:
block when &gt; 90% used). Set <code>max_instances &gt; 0</code> for a hard limit.</p>
</li>
<li>
<p><strong>Idle cleanup</strong>: Browsers are automatically closed after <code>idle_timeout_secs</code>
of inactivity.</p>
</li>
<li>
<p><strong>Network access</strong>: In host mode, the browser has full network access. In
sandbox mode, the browser can reach the internet but not local services.
Use firewall rules for additional restrictions.</p>
</li>
<li>
<p><strong>Sandbox scripts</strong>: Browser scripts running in the exec sandbox (Puppeteer,
Playwright) inherit sandbox network restrictions (<code>no_network: true</code> by default).</p>
</li>
</ol>
<h2 id="browser-detection"><a class="header" href="#browser-detection">Browser Detection</a></h2>
<p>Moltis automatically detects installed Chromium-based browsers in the following order:</p>
<ol>
<li><strong>Custom path</strong> from <code>chrome_path</code> config</li>
<li><strong>CHROME environment variable</strong></li>
<li><strong>Platform-specific app bundles</strong> (macOS/Windows)
<ul>
<li>macOS: <code>/Applications/Google Chrome.app</code>, <code>/Applications/Chromium.app</code>, etc.</li>
<li>Windows: <code>C:\Program Files\Google\Chrome\Application\chrome.exe</code>, etc.</li>
</ul>
</li>
<li><strong>PATH executables</strong> (fallback): <code>chrome</code>, <code>chromium</code>, <code>msedge</code>, <code>brave</code>, etc.</li>
</ol>
<p>If no browser is found, Moltis displays platform-specific installation instructions.</p>
<h3 id="supported-browsers"><a class="header" href="#supported-browsers">Supported Browsers</a></h3>
<p>Any Chromium-based browser works:</p>
<ul>
<li>Google Chrome</li>
<li>Chromium</li>
<li>Microsoft Edge</li>
<li>Brave</li>
<li>Opera</li>
<li>Vivaldi</li>
<li>Arc (macOS)</li>
</ul>
<h2 id="screenshot-display"><a class="header" href="#screenshot-display">Screenshot Display</a></h2>
<p>When the browser tool takes a screenshot, it’s displayed in the chat UI:</p>
<ul>
<li><strong>Thumbnail view</strong>: Screenshots appear as clickable thumbnails (200×150px max)</li>
<li><strong>Fullscreen lightbox</strong>: Click to view full-size with dark overlay</li>
<li><strong>Scrollable view</strong>: Long screenshots can be scrolled within the lightbox</li>
<li><strong>Download button</strong>: Save screenshot to disk (top of lightbox)</li>
<li><strong>Close button</strong>: Click ✕ button, click outside, or press Escape to close</li>
<li><strong>HiDPI scaling</strong>: Screenshots display at correct size on Retina displays</li>
</ul>
<p>Screenshots are base64-encoded PNGs returned in the tool result. The
<code>device_scale_factor</code> config (default: 2.0) controls the rendering resolution
for high-DPI displays.</p>
<h3 id="telegram-integration"><a class="header" href="#telegram-integration">Telegram Integration</a></h3>
<p>When using the Telegram channel, screenshots are automatically sent to the chat:</p>
<ul>
<li>Images sent as photos when dimensions are within Telegram limits</li>
<li>Automatically retried as documents for oversized images (aspect ratio &gt; 20)</li>
<li>Error messages sent to channel if delivery fails</li>
</ul>
<h2 id="handling-model-errors"><a class="header" href="#handling-model-errors">Handling Model Errors</a></h2>
<p>Some models (particularly Claude via GitHub Copilot) occasionally send malformed
tool calls with missing required fields. Moltis handles this gracefully:</p>
<ul>
<li><strong>Default action</strong>: If <code>url</code> is provided but <code>action</code> is missing, defaults to
<code>navigate</code></li>
<li><strong>Automatic retry</strong>: The agent loop retries with corrected arguments</li>
<li><strong>Muted error display</strong>: Validation errors show as muted/informational cards
in the UI (60% opacity, gray text) to indicate they’re expected, not alarming</li>
</ul>
<h2 id="troubleshooting"><a class="header" href="#troubleshooting">Troubleshooting</a></h2>
<h3 id="browser-not-launching"><a class="header" href="#browser-not-launching">Browser not launching</a></h3>
<ul>
<li>Ensure Chrome/Chromium is installed</li>
<li>Check <code>chrome_path</code> in config if using custom location</li>
<li>Set <code>CHROME</code> environment variable to specify browser path</li>
<li>On Linux, install dependencies: <code>apt-get install chromium-browser</code></li>
<li>On macOS, if using Homebrew Chromium, prefer installing Google Chrome or Brave
(the Homebrew chromium wrapper can be unreliable)</li>
</ul>
<h3 id="elements-not-found"><a class="header" href="#elements-not-found">Elements not found</a></h3>
<ul>
<li>Use <code>snapshot</code> to see available elements</li>
<li>Elements must be visible in the viewport</li>
<li>Some elements may need scrolling first</li>
</ul>
<h3 id="timeouts"><a class="header" href="#timeouts">Timeouts</a></h3>
<ul>
<li>Increase <code>navigation_timeout_ms</code> for slow pages</li>
<li>Use <code>wait</code> action to wait for dynamic content</li>
<li>Check network connectivity</li>
</ul>
<h3 id="high-memory-usage"><a class="header" href="#high-memory-usage">High memory usage</a></h3>
<ul>
<li>Browser instances are now limited by memory (blocks at 90% by default)</li>
<li>Set <code>max_instances &gt; 0</code> for a hard limit if preferred</li>
<li>Lower <code>idle_timeout_secs</code> to clean up faster</li>
<li>Consider enabling headless mode if not already</li>
</ul>
<h3 id="pool-exhaustion"><a class="header" href="#pool-exhaustion">Pool exhaustion</a></h3>
<ul>
<li>Browser tool now auto-tracks session IDs, preventing pool exhaustion from
LLMs that forget to pass session_id</li>
<li>If you still hit limits, check <code>memory_limit_percent</code> threshold</li>
<li>Use <code>close</code> action when done to free up sessions</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="sandbox.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="session-state.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="sandbox.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="session-state.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
